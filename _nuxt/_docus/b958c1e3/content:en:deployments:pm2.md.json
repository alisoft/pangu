{"key":"content:en:deployments:pm2.md","generatedAt":"2022-04-23T04:51:17.765Z","mtime":"2022-04-23T04:51:17.759Z","slug":"pm2","title":"PM2","position":"999999990000","to":"/deployments/pm2","draft":false,"page":true,"language":"en","template":"guide","description":"How to deploy Nuxt with PM2 cluster mode enabled?","target":"Server","category":"deployment","logo":{"light":"/img/companies/square/light/pm2.png","dark":"/img/companies/square/dark/pm2.png"},"empty":false,"body":{"raw":"---\ntemplate: guide\ntitle: PM2\ndescription: How to deploy Nuxt with PM2 cluster mode enabled?\ntarget: Server\ncategory: deployment\nlogo:\n  light: \"/img/companies/square/light/pm2.png\"\n  dark: \"/img/companies/square/dark/pm2.png\"\n---\n# Deploy Nuxt using PM2\n\nHow to deploy Nuxt with PM2 cluster mode enabled?\n\n---\n\nDeploying using [PM2](https://pm2.keymetrics.io/) (Process Manager 2) is a fast and easy solution for hosting your universal Nuxt application on your server or VM.\n\nIn this guide, we build the application locally and serve it though a PM2 config file with the cluster mode activated. Cluster mode will prevent downtime by allowing applications to be scaled across multiple CPUs.\n\n## Getting Started\n\nMake sure you have pm2 installed on your server. If not, simply globally install it from yarn or npm.\n\n```bash\n# yarn pm2 install\n$ sudo yarn global add pm2 --prefix /usr/local\n\n# npm pm2 install\n$ npm install pm2 -g\n```\n\n## Configure your application\n\nAll you need to add to your universal Nuxt app for serving it though PM2 is a file called `ecosystem.config.js`. Create a new file with that name in your root project directory and add the following content:\n\n```javascript\nmodule.exports = {\n  apps: [\n    {\n      name: 'NuxtAppName',\n      exec_mode: 'cluster',\n      instances: 'max', // Or a number of instances\n      script: './node_modules/nuxt/bin/nuxt.js',\n      args: 'start'\n    }\n  ]\n}\n```\n\n## Build and serve the app\n\nNow build your app with `npm run build`.\n\nAnd serve it with `pm2 start`.\n\nCheck the status `pm2 ls`.\n\nYour Nuxt application is now serving!\n\n## Further Information\n\nThis solution guarantees no downtime for your application on this server. (You should also prevent server failure through redundancy or high availability cloud solutions.)\n\nYou can find PM2 additional configurations [here](https://pm2.keymetrics.io/docs/usage/application-declaration/#general).\n","ast":{"type":"root","children":[{"type":"element","tag":"prose-h1","props":{"class":"d-heading-title","id":"deploy-nuxt-using-pm2"},"children":[{"type":"text","value":"Deploy Nuxt using PM2"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{"class":"d-heading-description"},"children":[{"type":"text","value":"How to deploy Nuxt with PM2 cluster mode enabled?"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-hr","props":{"class":"d-heading-hr"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Deploying using "},{"type":"element","tag":"prose-a","props":{"href":"https://pm2.keymetrics.io/","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"PM2"}]},{"type":"text","value":" (Process Manager 2) is a fast and easy solution for hosting your universal Nuxt application on your server or VM."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"In this guide, we build the application locally and serve it though a PM2 config file with the cluster mode activated. Cluster mode will prevent downtime by allowing applications to be scaled across multiple CPUs."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"getting-started"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#getting-started"},"children":[{"type":"text","value":"Getting Started"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Make sure you have pm2 installed on your server. If not, simply globally install it from yarn or npm."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-bash"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# yarn pm2 install"}]},{"type":"text","value":"\n$ "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"yarn"}]},{"type":"text","value":" global "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"add"}]},{"type":"text","value":" pm2 --prefix /usr/local\n\n"},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# npm pm2 install"}]},{"type":"text","value":"\n$ "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"npm"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"install"}]},{"type":"text","value":" pm2 -g\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"configure-your-application"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#configure-your-application"},"children":[{"type":"text","value":"Configure your application"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"All you need to add to your universal Nuxt app for serving it though PM2 is a file called "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"ecosystem.config.js"}]},{"type":"text","value":". Create a new file with that name in your root project directory and add the following content:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-javascript"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"module"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"exports"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","literal-property","property"]},"children":[{"type":"text","value":"apps"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","literal-property","property"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'NuxtAppName'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","literal-property","property"]},"children":[{"type":"text","value":"exec_mode"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'cluster'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","literal-property","property"]},"children":[{"type":"text","value":"instances"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'max'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// Or a number of instances"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","literal-property","property"]},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'./node_modules/nuxt/bin/nuxt.js'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","literal-property","property"]},"children":[{"type":"text","value":"args"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'start'"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"build-and-serve-the-app"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#build-and-serve-the-app"},"children":[{"type":"text","value":"Build and serve the app"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Now build your app with "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"npm run build"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"And serve it with "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"pm2 start"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Check the status "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"pm2 ls"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Your Nuxt application is now serving!"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"further-information"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#further-information"},"children":[{"type":"text","value":"Further Information"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"This solution guarantees no downtime for your application on this server. (You should also prevent server failure through redundancy or high availability cloud solutions.)"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"You can find PM2 additional configurations "},{"type":"element","tag":"prose-a","props":{"href":"https://pm2.keymetrics.io/docs/usage/application-declaration/#general","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"here"}]},{"type":"text","value":"."}]}]},"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"getting-started","depth":2,"text":"Getting Started"},{"id":"configure-your-application","depth":2,"text":"Configure your application"},{"id":"build-and-serve-the-app","depth":2,"text":"Build and serve the app"},{"id":"further-information","depth":2,"text":"Further Information"}]}}}