{"key":"content:en:docs:3.features:11.live-preview.md","generatedAt":"2022-04-23T10:19:19.046Z","mtime":"2022-04-23T10:19:19.036Z","slug":"live-preview","title":"Preview Mode","position":"999900030011","to":"/docs/features/live-preview","draft":false,"page":true,"language":"en","description":"Live Preview for target static with the preview mode","category":"features","empty":false,"body":{"raw":"---\ntitle: Preview Mode\ndescription: Live Preview for target static with the preview mode\ncategory: features\n---\n# Preview mode\n\nLive Preview for target static with the preview mode\n\n---\nWith Nuxt and full static you can now use live preview out of the box which will call your API or your CMS so you can see the changes live before deploying.\n\n::alert{type=\"warning\"}\nOnly available when using [`target:static`](/docs/features/deployment-targets#static-hosting)\n::\n\nThe preview mode will automatically refresh the page data as it uses `$nuxt.refresh` under the hood and therefore calls nuxtServerInit, asyncData and fetch on the client side.\n\nIn order to activate live preview you will need to add the following plugin:\n\n```js{}[plugins/preview.client.js]\nexport default function ({ query, enablePreview }) {\n  if (query.preview) {\n    enablePreview()\n  }\n}\n```\n\n::alert{type=\"warning\"}\n`enablePreview` is only available in the context object of plugins. Previews are handled client-side and\nthus the plugin should be run on the client: preview.client.js\n::\n\n```js{}[nuxt.config.js]\nexport default {\n  plugins: ['~/plugins/preview.client.js']\n}\n```\n\nOnce you have added the plugin you can now generate your site and serve it.\n\n::code-group\n```bash [Yarn]\nyarn generate\nyarn start\n```\n```bash [NPX]\nnpx nuxt generate\nnpx nuxt start\n```\n::\n\nThen you can see your preview page by adding the query param to the end of the page you want to see once:\n\n```js\n?preview=true\n```\n\n::alert{type=\"warning\"}\nenablePreview should be tested locally with yarn start and not yarn\ndev\n::\n\n### Previewing pages that are not yet generated\n\nFor pages that are not yet generated, SPA fallback will still call the API before showing the 404 page as these pages exist on the API but are not generated yet.\n\nIf you have set a validate hook, you will probably need to modify it so that it doesn't redirect to the 404 page in preview mode.\n\n```js\nvalidate({ params, query }) {\n  if (query.preview) {\n    return true\n}\n```\n\n### Passing data to enablePreview\n\nYou can pass data to the `enablePreview` function. That data will then be available on the `$preview` context helper and on `this.$preview`.\n\n### What's next\n\n::alert{type=\"next\"}\nCheck out the [Directory Structure book](/docs/directory-structure/nuxt)\n::\n","ast":{"type":"root","children":[{"type":"element","tag":"prose-h1","props":{"class":"d-heading-title","id":"preview-mode"},"children":[{"type":"text","value":"Preview mode"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{"class":"d-heading-description"},"children":[{"type":"text","value":"Live Preview for target static with the preview mode"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-hr","props":{"class":"d-heading-hr"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"With Nuxt and full static you can now use live preview out of the box which will call your API or your CMS so you can see the changes live before deploying."}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"warning"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Only available when using "},{"type":"element","tag":"prose-a","props":{"href":"/docs/features/deployment-targets#static-hosting"},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"target:static"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"The preview mode will automatically refresh the page data as it uses "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$nuxt.refresh"}]},{"type":"text","value":" under the hood and therefore calls nuxtServerInit, asyncData and fetch on the client side."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"In order to activate live preview you will need to add the following plugin:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"plugins/preview.client.js"}]},{"type":"element","tag":"pre","props":{"className":["line-numbers","language-js"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"function"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","parameter"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" query"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" enablePreview "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"if"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"query"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"preview"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"enablePreview"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"warning"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"enablePreview"}]},{"type":"text","value":" is only available in the context object of plugins. Previews are handled client-side and\nthus the plugin should be run on the client: preview.client.js"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"nuxt.config.js"}]},{"type":"element","tag":"pre","props":{"className":["line-numbers","language-js"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","literal-property","property"]},"children":[{"type":"text","value":"plugins"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'~/plugins/preview.client.js'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Once you have added the plugin you can now generate your site and serve it."}]},{"type":"text","value":"\n"},{"type":"element","tag":"code-group","props":{},"children":[{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"Yarn"}]},{"type":"element","tag":"pre","props":{"className":["line-numbers","language-bash"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"yarn"}]},{"type":"text","value":" generate\n"},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"yarn"}]},{"type":"text","value":" start\n"}]}]}]},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"NPX"}]},{"type":"element","tag":"pre","props":{"className":["line-numbers","language-bash"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"npx nuxt generate\nnpx nuxt start\n"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Then you can see your preview page by adding the query param to the end of the page you want to see once:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-js"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"?"}]},{"type":"text","value":"preview"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"true"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"warning"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"enablePreview should be tested locally with yarn start and not yarn\ndev"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"previewing-pages-that-are-not-yet-generated"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#previewing-pages-that-are-not-yet-generated"},"children":[{"type":"text","value":"Previewing pages that are not yet generated"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"For pages that are not yet generated, SPA fallback will still call the API before showing the 404 page as these pages exist on the API but are not generated yet."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"If you have set a validate hook, you will probably need to modify it so that it doesn't redirect to the 404 page in preview mode."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-js"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"validate"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","parameter"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" params"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" query "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"if"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"query"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"preview"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"true"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"passing-data-to-enablepreview"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#passing-data-to-enablepreview"},"children":[{"type":"text","value":"Passing data to enablePreview"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"You can pass data to the "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"enablePreview"}]},{"type":"text","value":" function. That data will then be available on the "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$preview"}]},{"type":"text","value":" context helper and on "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"this.$preview"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"whats-next"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#whats-next"},"children":[{"type":"text","value":"What's next"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"next"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Check out the "},{"type":"element","tag":"prose-a","props":{"href":"/docs/directory-structure/nuxt"},"children":[{"type":"text","value":"Directory Structure book"}]}]}]}]},"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"previewing-pages-that-are-not-yet-generated","depth":3,"text":"Previewing pages that are not yet generated"},{"id":"passing-data-to-enablepreview","depth":3,"text":"Passing data to enablePreview"},{"id":"whats-next","depth":3,"text":"What's next"}]}}}